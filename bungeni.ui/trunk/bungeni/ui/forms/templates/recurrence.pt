
<form>
    <fieldset>
        <legend>Details</legend>    
        <div class="error" tal:define="errors view/get_errors" tal:condition="errors">
         <h2 tal:condition="errors"> there were errors </h2>
          <ul tal:condition="errors">
            <li tal:repeat="error errors">
                <span tal:content="error/field" />:
                <span tal:content="error/msg" />                
            </li>
          </ul>
        </div>
        <div tal:condition="python:(view.get_group_id() is None)" 
            tal:define="error python: view.get_field_error('group_id')" 
            tal:attributes="class error/class">        
            <label for="formgroup_id">Group</label>   
            <select id="formgroup_id" name="group_id" size="1">
                <tal:loop tal:repeat="group view/get_groups">
                    <option value="plenary"
                    tal:attributes="value group/id; selected group/selected"
                    tal:content="group/name">Morning</option>                
                </tal:loop>
            </select>
            <b tal:condition="error/msg" tal:content="error/msg" />
        </div>
        <div tal:define="error python: view.get_field_error('sitting_type_id')" tal:attributes="class error/class">        
            <label for="formsitting_type_id">Sitting Type</label>   
            <select id="formsitting_type_id" name="sitting_type_id" size="1">
                <tal:loop tal:repeat="st view/get_sitting_types">
                    <option value="morning"
                    tal:attributes="value st/id; selected st/selected"
                    tal:content="st/name">Morning</option>                
                </tal:loop>
            </select>
            <b tal:condition="error/msg" tal:content="error/msg" />
        </div>            
        <div tal:define="error python: view.get_field_error('sitting_date')" tal:attributes="class error/class">        
            <label for="sitting-date"> Date </label>
            <input type="text" id="sitting-date"  name="sitting_date" size="10" 
                tal:attributes="value view/get_date"/>  
            <b tal:condition="error/msg" tal:content="error/msg" />
        </div>                
        <div tal:define="error python: view.get_field_error('sitting_start_time')" tal:attributes="class error/class">                         
            <label for="sitting-start-time"> Start </label>
            <input type="text" id="sitting-start-time" name="sitting_start_time" size="6" 
                tal:attributes="value view/get_start_time" />
            <b tal:condition="error/msg" tal:content="error/msg" />
        </div>              
        <div tal:define="error python: view.get_field_error('sitting_end_time')" tal:attributes="class error/class">                                 
            <label for="sitting-end-time"> End </label>
            <input type="text" id="sitting-end-time" name="sitting_end_time" size="6"
                tal:attributes="value view/get_end_time" />
            <b tal:condition="error/msg" tal:content="error/msg" />
        </div>                 
        <div tal:define="error python: view.get_field_error('venue_id')" tal:attributes="class error/class">
            <label for="formvenue_id">Venue</label>         
            <select id="formvenue_id" name="venue_id" size="1">
                <tal:loop tal:repeat="venue view/get_venues" >
                    <option tal:attributes="value venue/id; selected venue/selected" tal:content="venue/name">(no value)</option>
                </tal:loop>
            </select>
            <b tal:condition="error/msg" tal:content="error/msg" />
        </div>                
    </fieldset>
    <fieldset>
        <legend>Recurrence</legend>
        <input type="radio" checked="checked" id="notrecurrent" value="notrecurrent" name="recurrence"/>
        <label for="notrecurrent">No recurrence</label>
        <input type="radio" id="recurrentweekly" value="weekly" name="recurrence"/>
        <label for="recurrentweekly">Weekly</label>
        <input type="radio" id="recurrentmonthly" value="monthly" name="recurrence"/>
        <label for="recurrentmonthly">Monthly</label>
        <fieldset id="weeklyrecurrence" tal:define="weekday view/get_weekdays">
            <legend>Weekly</legend>   
            <span tal:repeat="day weekday">  
            <input type="checkbox" value="0" id="weekday_0" 
                tal:attributes="value day/daynum; id string:weekday_${day/daynum}; 
                checked day/checked; disabled day/disabled"
                name="weekdays"/>                       
            <label class="plain" for="weekday_0"
                tal:attributes="for string:weekday_${day/daynum}" tal:content="day/name">Mon</label>
            </span>
        </fieldset>
        <fieldset id="monthlyrecurrence">
            <legend>Monthly</legend>
            <span>
                <input id="monthly_m" type="radio" checked="checked" value="monthday" name="monthly"/>
                <label class="plain" for="monthly_m" tal:content="view/get_monthday"> Day 3 of every month</label>
            </span>
            <span tal:repeat="nth view/get_nth_monthday">
                <input id="monthly_w" type="radio" value="weekday" 
                tal:attributes="value nth/daynum; id string:monthly_${nth/daynum}"
                name="monthly"/>
                <label class="plain" for="monthly_w" 
                    tal:attributes="for string:monthly_${nth/daynum}"
                    tal:content="nth/name"> 1st Friday of every month</label>
            </span>
        </fieldset>
        <fieldset id="recurrencetimes">
            <legend>Repeat this event</legend>
            <span>
                <input type="radio" checked="checked" id="fieldrange_c" value="count" name="range"/>                
                <input id="fieldcount" type="text" value="1" size="3" name="count"/> 
                <label for="fieldrange_c"> times </label>
            </span>
            <br/>
            <span>
                <input id="fieldrange_u" type="radio" value="until" name="range"/>
                <label class="plain" for="field.range_u">Until </label>
                <input id="fielduntil" type="text" value="" name="until" />
            </span>
        </fieldset>
        <fieldset id="exceptiondates">
            <legend>Exception Dates</legend>
            <textarea id="fieldexceptions" rows="5" name="exceptions" cols="20"></textarea>
        </fieldset>
    </fieldset>
    <div id="actionsView">
        <span class="actionButtons">
            <input type="submit" value="Cancel" name="cancel" id="recurringformactionscancel" class="context"/>
            <input type="submit" value="Save" name="save" id="recurringformactionssave" class="context"/>
        </span>
    </div>    

    
</form>

