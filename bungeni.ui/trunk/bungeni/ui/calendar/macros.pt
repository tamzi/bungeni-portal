<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      i18n:translate="bungeni">

  <metal:navigation define-macro="navigation">
    <a class="navigation previous-link"
       tal:condition="options/links/previous|nothing"
       tal:attributes="href options/links/previous"
       i18n:translate="">
      &larr;
    </a>
    <a class="navigation next-link"
       tal:condition="options/links/next|nothing"
       tal:attributes="href options/links/next"
       i18n:translate="">
      &rarr;
    </a>
    <span i18n:translate=""
          tal:content="options/title" />
  </metal:navigation>

  <div metal:define-macro="sitting">
    <div class="calendar listing" id="sitting-calendar">
      <div id="calendar-header">
        <table class="listing grid">
          <thead>
            <tr>
              <td colspan="2">
                <metal:navigation use-macro="macros/navigation" />
              </td>
            </tr>
            <tr>
              <th class="description" colspan="2">
                <a rel="sitting" tal:attributes="href context/@@absolute_url"
                   i18n:translate=""
                   tal:content="options/description" />
              </th>
            </tr>
          </thead>
        </table>
      </div>
    </div>
    <div id="scheduling-calendar" class="scheduling-drop-target">
      <fieldset>
        <legend i18n:translate="">
          Items scheduled for this meeting
        </legend>

          <ul class="actions">
            <li tal:repeat="action options/actions">
              <a tal:attributes="rel action/id;
                                 href action/url">
                <span tal:condition="not: action/icon"
                      tal:replace="action/title" />
                <img tal:condition="action/icon"
                     tal:attributes="src action/icon;
                                     alt action/title" />
              </a>
            </li>
            <li>
              <a href="#" name="calendar" rel="calendar"
                 i18n:translate=""
                 tal:define="url request/getURL"
                 tal:attributes="href string:$url?${request/QUERY_STRING}">
                Refresh
              </a>
            </li>
          </ul>
          
          <table tal:define="images nocall: context/++resource++ui-images"
                 tal:condition="options/items"
                 id="scheduling-table" class="grid listing">
            <thead>
              <tr>
                <th i18n:translate="">Item</th>
                <th i18n:translate="">State</th>
                <th i18n:translate="">Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr tal:repeat="item options/items">
                <td>
                  <a rel="item"
                     tal:attributes="name item/name;
                                     href item/url"
                     tal:content="item/title" />
                </td>
                <td tal:content="item/status" />
                <td class="actions">
                  <a href="#" rel="move-up" i18n:translate="">
                    <img alt="Up-arrow"
                         i18n:attributes="alt"
                         tal:attributes="src images/icon_up.gif" />
                  </a>
                  <a href="#" rel="move-down" i18n:translate="">
                    <img alt="Down-arrow"
                         i18n:attributes="alt"
                         tal:attributes="src images/icon_down.gif" />
                  </a>
                </td>
              </tr>
            </tbody>
          </table>
          <p tal:condition="not: options/items"
             i18n:translate="">
            No items scheduled.
          </p>
        </fieldset>
    </div>
  </div>
    
  <div metal:define-macro="daily">
    <div class="calendar listing" id="daily-calendar">
      <div id="calendar-header">
        <table class="listing grid">
          <thead>
            <tr>
              <td colspan="2">
                <metal:navigation use-macro="macros/navigation" />
              </td>
            </tr>
          </thead>
        </table>
      </div>
      
      <div id="calendar-table">
        <table class="listing grid">
          <thead>
            <tr>        
              <th>
                <a i18n:translate=""
                   rel="calendar"
                   tal:attributes="href string:${request/getURL}?${request/QUERY_STRING}">
                  Week <span i18n:name="week_no" tal:replace="options/week_no" />
                </a>
              </th>
              <th class="day"
                  tal:define="day options/day"
                  tal:attributes="id string:tdid-${day/id};
                                  class python: default + ' ' + (day['today'] and 'today' or '')">
                <a tal:attributes="href day/url">
                  <b tal:content="day/formatted" />
                </a>
              </th>
            </tr>
          </thead>
        

          <tbody tal:define="sittings_map options/sittings_map;
                             url request/getURL">
            <tr tal:repeat="hour options/hours">
              <td class="hour" tal:content="string: ${hour}:00" />
              <tal:column define="day options/week_day">
                <td tal:define="sitting python: sittings_map.get((day, hour), False);
                                today_class python: options['day']['today'] and 'today' or None"
                    tal:attributes="rowspan sitting/span|nothing;
                                    class string:${sitting/class|string:} ${today_class};
                                    id string:sitting-${sitting/record/sitting_id}|nothing"
                    tal:condition="python: sitting is not None">
                  <tal:sitting condition="sitting">
                    <div class="header">
                      <a rel="sitting" tal:attributes="href sitting/url">
                        <span class="discreet">
                          <span i18n:translate=""
                                tal:replace="sitting/formatted_start_time" />
                          -
                          <span i18n:translate=""
                                tal:replace="sitting/formatted_end_time" />
                        </span>
                        
                        <span class="sitting-type" 
                              tal:content="string:(${sitting/record/sitting_type/sitting_type})" />
                      </a>
                    </div>

                    <div class="sitting">
                      <ul class="actions">
                        <li tal:repeat="action sitting/actions">
                          <a tal:attributes="rel action/id;
                                             href action/url">
                            <span tal:condition="not: action/icon"
                                  tal:replace="action/title" />
                            <img tal:condition="action/icon"
                                 tal:attributes="src action/icon;
                                                 alt action/title" />
                          </a>
                        </li>
                      </ul>
                      
                      <ul class="items" tal:condition="sitting/items">
                        <li tal:repeat="item sitting/items">
                          <a tal:attributes="name item/name;
                                             href item/url"
                             tal:content="item/title" />
                          &mdash;
                          <a class="delete-link"
                             tal:attributes="href string:${item/delete_url}?next_url=${url}">
                            Remove
                          </a>
                          
                          <p class="discreet"
                             tal:content="item/description" />
                          
                        </li>
                      </ul>
                    </div>
                  </tal:sitting>
                </td>
              </tal:column>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  
  <div metal:define-macro="weekly">
    <div class="calendar listing" id="weekly-calendar">
      <div id="calendar-header">
        <table class="listing grid">
          <thead>
            <tr>
              <td colspan="8">
                <metal:navigation use-macro="macros/navigation" />
              </td>
            </tr>
          </thead>
        </table>
      </div>
      
      <div id="calendar-table">
        <table class="listing grid">
          <thead>
            <tr>        
              <th>
                <a i18n:translate=""
                   rel="calendar"
                   tal:attributes="href string:${request/getURL}?${request/QUERY_STRING}">
                  Week <span i18n:name="week_no" tal:replace="options/week_no" />
                </a>
              </th>
              <th class="day"
                  tal:repeat="day options/days"
                  tal:attributes="id string:tdid-${day/id};
                                  class python: default + ' ' + (day['today'] and 'today' or '')">
                <a tal:attributes="href day/url">
                  <b tal:content="day/formatted" />
                </a>
              </th>
            </tr>
          </thead>
        

          <tbody tal:define="sittings_map options/sittings_map;
                             url request/getURL">
            <tr tal:repeat="hour options/hours">
              <td class="hour" tal:content="string: ${hour}:00" />
              <tal:column repeat="day python: range(7)">
                <td tal:define="sitting python: sittings_map.get((day, hour), False);
                                today_class python: options['days'][day]['today'] and 'today' or None"
                    tal:attributes="rowspan sitting/span|nothing;
                                    class string:${sitting/class|string:} ${today_class};
                                    id string:sitting-${sitting/record/sitting_id}|nothing"
                    tal:condition="python: sitting is not None">
                  <tal:sitting condition="sitting">
                    <div class="header">
                      <a rel="sitting" tal:attributes="href sitting/url">
                        <span class="discreet">
                          <span i18n:translate=""
                                tal:replace="sitting/formatted_start_time" />
                          -
                          <span i18n:translate=""
                                tal:replace="sitting/formatted_end_time" />
                        </span>
                        
                        <span class="sitting-type" 
                              tal:content="string:(${sitting/record/sitting_type/sitting_type})" />
                      </a>
                    </div>

                    <div class="sitting">
                      <ul class="actions">
                        <li tal:repeat="action sitting/actions">
                          <a tal:attributes="rel action/id;
                                             href action/url">
                            <span tal:condition="not: action/icon"
                                  tal:replace="action/title" />
                            <img tal:condition="action/icon"
                                 tal:attributes="src action/icon;
                                                 alt action/title" />
                          </a>
                        </li>
                      </ul>
                      
                      <ul class="items" tal:condition="sitting/items">
                        <li tal:repeat="item sitting/items">
                          <a tal:attributes="name item/name;
                                             href item/url"
                             tal:content="item/title" />
                          &mdash;
                          <a class="delete-link"
                             tal:attributes="href string:${item/delete_url}?next_url=${url}">
                            Remove
                          </a>
                          
                          <p class="discreet"
                             tal:content="item/description" />
                          
                        </li>
                      </ul>
                    </div>
                  </tal:sitting>
                </td>
              </tal:column>
            </tr>
          </tbody>
        </table>
      </div>
      
    </div>
  </div>
  
</html>  
